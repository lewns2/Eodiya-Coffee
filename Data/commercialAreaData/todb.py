import pymysql


conn = pymysql.connect(host='j6e203.p.ssafy.io',
                       port=3636,
                       user='ssafy',
                       password='Ssafy203!!',
                       db='ssafy_bigdata',
                       charset='utf8')

# sql = "SELECT * FROM commercial_area_commercialarea"
sql = "SELECT * FROM commercial_area_commercialarea WHERE commercialAreaCode = 1001252"

with conn:
    with conn.cursor() as cur:
        cur.execute(sql)
        result = cur.fetchall()
        # print(result)
        for res in result:
            # print(res)
            try:
                # print(res[3])
                tmp = eval(''.join(res[3]))
                # print(tmp)
                min_xv = 999
                min_yv = 999
                max_xv = 0
                max_yv = 0
                for i in tmp:
                    if max_xv < i[0]:
                        max_xv = i[0]
                    if min_xv > i[0]:
                        min_xv = i[0]
                    if max_yv < i[1]:
                        max_yv = i[1]
                    if min_yv > i[1]:
                        min_yv = i[1]
                center_x = (min_xv + max_xv) / 2
                center_y = (min_yv + max_yv) / 2
                # print(res[0], center_x, center_y)
                new_sql = 'UPDATE commercial_area_commercialarea SET commercialCenterXPoint = %s, commercialCenterYPoint = %s WHERE commercialAreaCode = %s'
                cur.execute(new_sql, (center_x, center_y, res[0]))
                conn.commit()
            except:
                pass
# newnew = [[127.03025513107195, 37.610390110686104], [127.02913334982294, 37.6104540928828], [127.02923336975951, 37.61106935363988], [127.02897295019767, 37.61154919454044], [127.02801802879294, 37.61144112623544], [127.02828565672446, 37.612036345826944], [127.02756934112652, 37.61216616765319], [127.0276808264424, 37.61257483012419], [127.02846490035417, 37.61251139418661], [127.0301943027413, 37.61232743293558], [127.03025513107195, 37.610390110686104]], [[127.02842065396044, 37.61469495100701], [127.02830968975597, 37.613588563635126], [127.02853902149522, 37.612936643022806], [
#     127.0283332711309, 37.612753611670016], [127.02719561469809, 37.612868124711966], [127.0270441886461, 37.61381464820348], [127.0268658087447, 37.6144647522503], [127.02734294255072, 37.61465907599581], [127.02815979913966, 37.614668614577155], [127.02842065396044, 37.61469495100701], [127.02986398746012, 37.61644917941024], [127.02996528180584, 37.6145600513056], [127.02955477764249, 37.61474647926152], [127.02878389809254, 37.61471936985449], [127.02876436963527, 37.61518491537924], [127.02859153445493, 37.61549489740823], [127.02927208569331, 37.616513027589455], [127.02986398746012, 37.61644917941024]]
# '[127.05776051383953, 37.504834609623614], [127.05697530663345, 37.504569284494686], [127.05650436588793, 37.50441003275729], [127.05616812040181, 37.503943382231434], [127.05495684667171, 37.50329847164764], [127.05467923928985, 37.50381830042945], [127.05401351827065, 37.50360344659953], [127.05388490803111, 37.50231506737179], [127.0532968965427, 37.50337185328245], [127.05294554411138, 37.50325812418385], [127.05323158955198, 37.50266234084862], [127.05249688223174, 37.502427777467354], [127.0523236495358, 37.50181706255869], [127.05264864872288, 37.50113260425407], [127.05086276327751, 37.50054331791793], [127.04973807587179, 37.502925515464405], [127.04898297379773, 37.50452439488933], [127.05080392381568, 37.50500196949419], [127.05295209839076, 37.5056527231485], [127.05669135292837, 37.50685455033843], [127.05776051383953, 37.504834609623614]'
# min_xv = 999
# min_yv = 999
# max_xv = 0
# max_yv = 0
# for i in newnew:
#     print(i)
#     if max_xv < i[0]:
#         max_xv = i[0]
#     if min_xv > i[0]:
#         min_xv = i[0]
#     if max_yv < i[1]:
#         max_yv = i[1]
#     if min_yv > i[1]:
#         min_yv = i[1]
# center_x = (min_xv + max_xv) / 2
# center_y = (min_yv + max_yv) / 2

# print(center_x, center_y)
